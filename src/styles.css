/* src/styles.css */

/* -------------------------------------------------------
   Tailwind layers
------------------------------------------------------- */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* -------------------------------------------------------
   Design tokens (safe defaults for low glare + contrast)
------------------------------------------------------- */
:root {
  /* Stage & sprite tuning */
  --stage-w: 960px;
  --stage-h: 480px;
  --sprite-size: 96px;
  --sprite-frames: 8;
  --sprite-fps: 8;

  /* Shadows & radii */
  --radius-xl: 1rem;
  --shadow-1: 0 1px 3px rgba(0,0,0,0.25), 0 6px 20px rgba(0,0,0,0.18);

  /* Colors tuned for readability (dark default) */
  --bg: #0b1220;           /* deep slate */
  --surf: #0f172a;         /* slate-900 */
  --surf-2: #111827;       /* near slate-900 */
  --text: #e5e7eb;         /* gray-200 */
  --text-muted: #cbd5e1;   /* slate-300 */
  --border: #334155;       /* slate-600 */
  --accent: #f8fafc;       /* near-white */
  --accent-2: #cbd5e1;     /* slate-300 */
}

/* Dark/light theme variables (if you use darkMode: "class") */
:root.dark {
  --bg: #0b1220;
  --surf: #0f172a;
  --surf-2: #111827;
  --text: #e5e7eb;
  --text-muted: #cbd5e1;
  --border: #334155;
  --accent: #f8fafc;
  --accent-2: #cbd5e1;
}
:root.light {
  --bg: #ffffff;
  --surf: #ffffff;
  --surf-2: #f8fafc;
  --text: #0b1220;
  --text-muted: #334155;
  --border: #e5e7eb;
  --accent: #0b1220;
  --accent-2: #334155;
}

/* -------------------------------------------------------
   Base reset + high-contrast foundation
------------------------------------------------------- */
@layer base {
  html, body, #root { height: 100%; }

  body {
    @apply antialiased;
    background: var(--bg);
    color: var(--text);
  }

  /* Better default focus visible */
  :focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

  /* Accessible selection color */
  ::selection { background: #94a3b8; color: #0b1220; } /* slate-400 on dark */

  /* Firefox scrollbars */
  * {
    scrollbar-width: thin;
    scrollbar-color: #475569 #0b1220; /* thumb track */
  }
}
/* WebKit scrollbars (feature-detected) */
@supports selector(::-webkit-scrollbar) {
  *::-webkit-scrollbar { height: 12px; width: 12px; }
  *::-webkit-scrollbar-track { background: #0b1220; }
  *::-webkit-scrollbar-thumb {
    background: #475569;
    border: 3px solid #0b1220;
    border-radius: 9999px;
  }
}

/* -------------------------------------------------------
   Components (reusable primitives)
------------------------------------------------------- */
@layer components {
  /* Card surface with low-glare glass */
  .card {
    @apply rounded-2xl border border-white/15 bg-slate-900/70 backdrop-blur p-4;
    box-shadow: var(--shadow-1);
  }

  .glass { @apply bg-slate-800/50 backdrop-blur-md border border-white/10; }

  /* Button system with variants */
  .btn {
    @apply inline-flex items-center justify-center gap-2
           px-4 py-2 rounded-xl font-semibold
           border border-white/15 text-slate-900
           transition-transform duration-150
           active:scale-[0.98];
    background: var(--accent);
  }
  /* Safe hover fallback for older engines */
  .btn:hover { background: #e5e7eb; }
  /* Fancy mix when supported */
  @supports (background: color-mix(in srgb, white 10%, black)) {
    .btn:hover { background: color-mix(in oklab, var(--accent), #cbd5e1 15%); }
  }
  .btn:disabled { @apply opacity-60 pointer-events-none; }

  .btn--ghost { @apply border border-white/20 text-white; background: transparent; }
  .btn--ghost:hover { background: rgba(255,255,255,0.06); }

  .btn--warn { @apply text-slate-900; background: #fbbf24; border-color: #fbbf24; }
  .btn--warn:hover { background: #f59e0b; }

  /* Badge / Pill */
  .badge {
    @apply inline-flex items-center rounded-lg px-2 py-0.5 text-xs
           border border-white/15 bg-white/5 text-white/80;
  }
  .pill {
    @apply inline-flex items-center rounded-full px-3 py-1 text-xs
           border border-white/15 bg-white/10 text-white/90;
  }

  /* Keyboard hint */
  .kbd {
    @apply inline-flex items-center justify-center min-w-[1.5rem] h-6
           px-1.5 rounded-md border border-white/20 bg-slate-800 text-xs
           text-white/90 shadow;
  }

  /* Meter shell (use with inline fill) */
  .meter { @apply relative h-3 w-full overflow-hidden rounded-full bg-white/10; }
  .meter__fill { @apply h-full bg-white/80; width: 0%; }

  /* Modal shell (portal-less simple modal) */
  .modal { @apply fixed inset-0 z-50 grid place-items-center p-4 bg-black/70; }
  .modal__panel { @apply w-full max-w-md rounded-2xl border border-white/15 bg-slate-900 p-5 shadow-xl; }
}

/* -------------------------------------------------------
   Utilities: sprite helpers, yard stripe, no-color cues
------------------------------------------------------- */
@layer utilities {
  /* Stage bounds (dashed for non-color cue) */
  .stage-box {
    @apply relative rounded-xl border border-dashed border-white/20 overflow-hidden;
    width: var(--stage-w);
    height: var(--stage-h);
  }

  /* Yard zone stripe on the right with label (not color-only) */
  .yard-zone {
    @apply absolute inset-y-0 right-0 flex items-center justify-center pointer-events-none;
    width: 10rem; /* 160px */
    background: rgba(16, 185, 129, 0.18); /* emerald-500/18 */
    border-left: 1px solid rgba(16, 185, 129, 0.35);
  }
  .yard-zone__label {
    @apply rotate-90 text-xs;
    color: #a7f3d0; /* emerald-200 */
    text-shadow: 0 1px 0 rgba(0,0,0,0.6);
  }

  /* Sprite sheet animation via CSS (optional if you prefer JS) */
  .sprite {
    width: var(--sprite-size);
    height: var(--sprite-size);
    image-rendering: pixelated;
    background-repeat: no-repeat;
    background-size: calc(var(--sprite-size) * var(--sprite-frames)) var(--sprite-size);
    filter: drop-shadow(0 0 6px rgba(0,0,0,0.35));
  }
  .sprite--playing {
    animation: sprite-walk steps(var(--sprite-frames)) calc(1000ms / var(--sprite-fps)) infinite;
  }
  .sprite--flip { transform: scaleX(-1); }

  /* Focus ring alt (for elements without default outline) */
  .focus-ring { outline: 2px solid var(--accent); outline-offset: 2px; }

  /* Subtle divider */
  .divider { @apply h-px w-full bg-white/10; }
}

/* -------------------------------------------------------
   Keyframes
------------------------------------------------------- */
@keyframes sprite-walk {
  from { background-position: 0 0; }
  to   { background-position: calc(var(--sprite-size) * var(--sprite-frames) * -1) 0; }
}

/* -------------------------------------------------------
   Motion preferences & media safety
------------------------------------------------------- */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }
}

/* -------------------------------------------------------
   Print (for docs/receipts, not gameplay)
------------------------------------------------------- */
@media print {
  .no-print { display: none !important; }
  body { background: #fff; color: #000; }
  .card, .glass { box-shadow: none; border-color: #000; }
}
@page { margin: 1cm; }

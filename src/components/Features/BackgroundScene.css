/* src/components/Features/BackgroundScene.css */

/* -------------
   Core contract
   ------------- */
.bg-yard {
  --scene-accent: #10b981; /* default accent (emerald-500) */

  /* depth/parallax */
  --z-back: -2;
  --z-mid: -1;
  --z-front: 0;

  /* stage sizing (inherits parent width) */
  --stage-height: 480px;

  position: relative;
  overflow: hidden;
  min-height: var(--stage-height);
  width: 100%;

  /* Enable 3D for children */
  perspective: 800px;
  transform-style: preserve-3d;

  /* Rounded container looks nice inside cards */
  border-radius: 1rem;
}

/* Stage content (your game) sits above parallax layers */
.bg-yard .scene-stage {
  position: relative;
  z-index: 10;
  pointer-events: auto;
}

/* Ground strip at bottom */
.bg-yard .scene-ground {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;

  height: 72px;
  z-index: 5;
  background:
    linear-gradient(to top, rgba(0,0,0,0.18), rgba(0,0,0,0) 60%),
    linear-gradient(0deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)),
    var(--ground-fill, #2f3e46);
  border-top: 1px solid rgba(255,255,255,0.12);
}

/* -------------
   Parallax layers
   ------------- */
.parallax.layer {
  position: absolute;
  inset: 0;
  will-change: transform;
  pointer-events: none;
  background-repeat: no-repeat;
  background-size: cover;
  background-position: center;
  filter: var(--layer-filter, none);
}

/* Back layer (sky, mountains) */
.parallax.layer.back {
  z-index: 1;
  transform: translateZ(calc(var(--z-back) * 1px)) scale(1.02);
  background-image: var(--back-image, none);
  background: var(--back-gradient);
}

/* Mid layer (hills, trees, haze) */
.parallax.layer.mid {
  z-index: 3;
  transform: translateZ(calc(var(--z-mid) * 1px)) scale(1.01);
  background-image: var(--mid-image, none);
  background: var(--mid-gradient);
  opacity: var(--mid-opacity, 0.85);
}

/* Front layer (nearby plants, particles) */
.parallax.layer.front {
  z-index: 7;
  transform: translateZ(calc(var(--z-front) * 1px));
  background-image: var(--front-image, none);
  background: var(--front-gradient);
  mix-blend-mode: var(--front-blend, normal);
  opacity: var(--front-opacity, 0.9);
}

/* -------------
   Motion safety
   ------------- */
@media (prefers-reduced-motion: reduce) {
  .parallax.layer {
    transform: none !important;
  }
}

/* -------------
   Skins
   ------------- */

/* DEFAULT: neutral blue hour */
.bg-yard.skin-default {
  --sky-top: #0b1020;
  --sky-mid: #0f1730;
  --sky-bot: #111a33;

  --haze: rgba(148,163,184,0.10); /* slate-400/10 */
  --haze-strong: rgba(148,163,184,0.16);

  --ground-fill: #1f2937; /* gray-800 */

  --back-gradient:
    linear-gradient(180deg, var(--sky-top), var(--sky-mid) 55%, var(--sky-bot));
  --mid-gradient:
    radial-gradient(80% 60% at 50% 20%, var(--haze), transparent 70%);
  --front-gradient:
    radial-gradient(70% 40% at 50% 90%, rgba(255,255,255,0.06), transparent 60%);
}

/* LAWN: daylight greens */
.bg-yard.skin-lawn {
  --sky-top: #bce1ff;
  --sky-mid: #d5ecff;
  --sky-bot: #eef7ff;

  --ground-fill: #3b7f4a;

  --back-gradient:
    linear-gradient(180deg, var(--sky-top), var(--sky-mid) 55%, var(--sky-bot));
  --mid-gradient:
    radial-gradient(80% 60% at 50% 25%, rgba(16,185,129,0.18), transparent 70%);
  --front-gradient:
    radial-gradient(80% 35% at 50% 90%, rgba(0,0,0,0.06), transparent 60%);
}

/* SUNSET: warm gradient with accent tint */
.bg-yard.skin-sunset {
  --sky-top: #3b0d47;  /* plum-900 */
  --sky-mid: #7c2156;  /* magenta-700 */
  --sky-bot: #f97316;  /* orange-500 */

  --ground-fill: #3a2f3b;

  --back-gradient:
    linear-gradient(180deg, var(--sky-top), var(--sky-mid) 55%, var(--sky-bot));
  --mid-gradient:
    radial-gradient(90% 60% at 50% 20%, color-mix(in oklab, var(--scene-accent), #ffffff 70%) , transparent 70%);
  --front-gradient:
    radial-gradient(70% 40% at 50% 90%, rgba(255,255,255,0.08), transparent 60%);
}

/* NIGHT: deep blue with starlight speckle */
.bg-yard.skin-night {
  --sky-top: #050b19;
  --sky-mid: #081125;
  --sky-bot: #0a1530;

  --ground-fill: #0f1a2b;

  --back-gradient:
    linear-gradient(180deg, var(--sky-top), var(--sky-mid) 55%, var(--sky-bot));
  --mid-gradient:
    radial-gradient(100% 70% at 50% 15%, rgba(147,197,253,0.12), transparent 70%);
  --front-gradient:
    radial-gradient(80% 40% at 50% 85%, rgba(255,255,255,0.06), transparent 60%);
  --layer-filter: saturate(0.95);
}

/* NEON: cyber grid glow using accent */
.bg-yard.skin-neon {
  --sky-top: #070711;
  --sky-mid: #0b0b1a;
  --sky-bot: #0f0f24;

  --ground-fill: #0c0c1a;

  --back-gradient:
    radial-gradient(120% 100% at 50% 10%, color-mix(in oklab, var(--scene-accent), #000 75%), #090914 70%);
  --mid-gradient:
    repeating-linear-gradient(
      0deg,
      color-mix(in oklab, var(--scene-accent), #000 80%) 0px,
      color-mix(in oklab, var(--scene-accent), #000 80%) 1px,
      transparent 1px,
      transparent 18px
    );
  --front-gradient:
    radial-gradient(70% 30% at 50% 90%, color-mix(in oklab, var(--scene-accent), #fff 85%) , transparent 60%);
  --front-blend: screen;
  --front-opacity: 0.7;
}

/* WINTER: cold sky + frosty ground */
.bg-yard.skin-winter {
  --sky-top: #e6f3ff;
  --sky-mid: #f3f9ff;
  --sky-bot: #ffffff;

  --ground-fill: #b7c4cf;

  --back-gradient:
    linear-gradient(180deg, var(--sky-top), var(--sky-mid) 55%, var(--sky-bot));
  --mid-gradient:
    radial-gradient(75% 50% at 50% 20%, rgba(59,130,246,0.18), transparent 70%); /* blue-500/18 */
  --front-gradient:
    radial-gradient(70% 40% at 50% 90%, rgba(0,0,0,0.05), transparent 60%);
}

/* -------------
   Responsiveness
   ------------- */
@media (max-width: 768px) {
  .bg-yard { --stage-height: 380px; border-radius: 0.75rem; }
  .bg-yard .scene-ground { height: 56px; }
}

@media (max-width: 480px) {
  .bg-yard { --stage-height: 320px; border-radius: 0.75rem; }
  .bg-yard .scene-ground { height: 48px; }
}

/* -------------
   Fallbacks for older engines (color-mix)
   ------------- */
@supports not (background: color-mix(in srgb, white 10%, black)) {
  .bg-yard.skin-sunset { --mid-gradient:
    radial-gradient(90% 60% at 50% 20%, rgba(248, 113, 113, 0.2), transparent 70%); /* rose-ish fallback */
  }
  .bg-yard.skin-neon .parallax.layer.front { opacity: 0.75; }
}

/* -------------
   Optional: simple hover parallax when mouse moves (progressive enhancement)
   ------------- */
.bg-yard:hover .parallax.layer.back { transform: translateZ(calc(var(--z-back) * 1px)) translateY(-2px) scale(1.02); }
.bg-yard:hover .parallax.layer.mid  { transform: translateZ(calc(var(--z-mid) * 1px))  translateY(-1px) scale(1.01); }
.bg-yard:hover .parallax.layer.front{ transform: translateZ(calc(var(--z-front) * 1px))              scale(1.00); }
@media (hover: none) {
  .bg-yard:hover .parallax.layer.back,
  .bg-yard:hover .parallax.layer.mid,
  .bg-yard:hover .parallax.layer.front { transform: none; }
}
